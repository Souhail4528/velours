{% extends "base.html" %}

{% block title %}Paramètres du Footer - Admin{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-tachometer-alt"></i> Administration</h5>
                </div>
                <div class="list-group list-group-flush">
                    <a href="{{ url_for('admin_dashboard') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-home"></i> Dashboard
                    </a>
                    <a href="{{ url_for('admin_products') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-gem"></i> Produits
                    </a>
                    <a href="{{ url_for('admin_orders') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-shopping-bag"></i> Commandes
                    </a>
                    <a href="{{ url_for('admin_stock') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-boxes"></i> Stock
                    </a>
                    <a href="{{ url_for('admin_sliders') }}" class="list-group-item list-group-item-action">
                        <i class="fas fa-images"></i> Sliders
                    </a>
                    <a href="{{ url_for('admin_footer') }}" class="list-group-item list-group-item-action active">
                        <i class="fas fa-footer"></i> Footer
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="col-md-9">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>Paramètres du Footer</h2>
                <button type="button" class="btn btn-info" onclick="previewFooter()">
                    <i class="fas fa-eye"></i> Aperçu
                </button>
            </div>
            
            <form method="POST">
                <!-- Informations de l'entreprise -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-building"></i> Informations de l'entreprise</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="company_name" class="form-label">Nom de l'entreprise *</label>
                                    <input type="text" class="form-control" id="company_name" name="company_name" value="{{ settings.company_name }}" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="company_description" class="form-label">Description de l'entreprise</label>
                                    <textarea class="form-control" id="company_description" name="company_description" rows="3">{{ settings.company_description or '' }}</textarea>
                                    <div class="form-text">Description qui apparaît dans le footer</div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="address" class="form-label">Adresse</label>
                                    <textarea class="form-control" id="address" name="address" rows="3">{{ settings.address or '' }}</textarea>
                                    <div class="form-text">Adresse complète (utilisez Entrée pour les sauts de ligne)</div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="copyright_text" class="form-label">Texte de copyright</label>
                                    <input type="text" class="form-control" id="copyright_text" name="copyright_text" value="{{ settings.copyright_text or '' }}">
                                    <div class="form-text">Ex: © 2024 Bijoux Store. Tous droits réservés.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Contact -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-phone"></i> Informations de contact</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="phone" class="form-label">Téléphone</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" value="{{ settings.phone or '' }}">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" name="email" value="{{ settings.email or '' }}">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="opening_hours" class="form-label">Horaires d'ouverture</label>
                                    <textarea class="form-control" id="opening_hours" name="opening_hours" rows="4">{{ settings.opening_hours or '' }}</textarea>
                                    <div class="form-text">Horaires d'ouverture (utilisez Entrée pour les sauts de ligne)</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Réseaux sociaux -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-share-alt"></i> Réseaux sociaux</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="facebook_url" class="form-label">
                                        <i class="fab fa-facebook-f"></i> Facebook
                                    </label>
                                    <input type="url" class="form-control" id="facebook_url" name="facebook_url" value="{{ settings.facebook_url or '' }}" placeholder="https://facebook.com/votrepage">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="instagram_url" class="form-label">
                                        <i class="fab fa-instagram"></i> Instagram
                                    </label>
                                    <input type="url" class="form-control" id="instagram_url" name="instagram_url" value="{{ settings.instagram_url or '' }}" placeholder="https://instagram.com/votrepage">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="twitter_url" class="form-label">
                                        <i class="fab fa-twitter"></i> Twitter
                                    </label>
                                    <input type="url" class="form-control" id="twitter_url" name="twitter_url" value="{{ settings.twitter_url or '' }}" placeholder="https://twitter.com/votrepage">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="linkedin_url" class="form-label">
                                        <i class="fab fa-linkedin-in"></i> LinkedIn
                                    </label>
                                    <input type="url" class="form-control" id="linkedin_url" name="linkedin_url" value="{{ settings.linkedin_url or '' }}" placeholder="https://linkedin.com/company/votrepage">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="youtube_url" class="form-label">
                                        <i class="fab fa-youtube"></i> YouTube
                                    </label>
                                    <input type="url" class="form-control" id="youtube_url" name="youtube_url" value="{{ settings.youtube_url or '' }}" placeholder="https://youtube.com/votrepage">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Newsletter -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-envelope-open"></i> Newsletter</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="show_newsletter" name="show_newsletter" {% if settings.show_newsletter %}checked{% endif %}>
                                <label class="form-check-label" for="show_newsletter">
                                    Afficher la section newsletter dans le footer
                                </label>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newsletter_title" class="form-label">Titre de la newsletter</label>
                                    <input type="text" class="form-control" id="newsletter_title" name="newsletter_title" value="{{ settings.newsletter_title or '' }}">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newsletter_description" class="form-label">Description de la newsletter</label>
                                    <textarea class="form-control" id="newsletter_description" name="newsletter_description" rows="2">{{ settings.newsletter_description or '' }}</textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="d-flex justify-content-between">
                    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Retour au Dashboard
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Enregistrer les modifications
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal d'aperçu -->
<div class="modal fade" id="previewModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Aperçu du Footer</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-0">
                <div id="footerPreview" class="bg-dark text-light p-4">
                    <!-- L'aperçu sera généré ici -->
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function previewFooter() {
    // Récupérer les valeurs du formulaire
    const companyName = document.getElementById('company_name').value;
    const companyDescription = document.getElementById('company_description').value;
    const address = document.getElementById('address').value;
    const phone = document.getElementById('phone').value;
    const email = document.getElementById('email').value;
    const openingHours = document.getElementById('opening_hours').value;
    const copyrightText = document.getElementById('copyright_text').value;
    const showNewsletter = document.getElementById('show_newsletter').checked;
    const newsletterTitle = document.getElementById('newsletter_title').value;
    const newsletterDescription = document.getElementById('newsletter_description').value;
    
    // Générer l'aperçu
    const preview = `
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4">
                    <h5><i class="fas fa-gem"></i> ${companyName}</h5>
                    ${companyDescription ? `<p>${companyDescription}</p>` : ''}
                    <div class="social-links mt-3">
                        <a href="#" class="text-light me-3"><i class="fab fa-facebook-f fa-lg"></i></a>
                        <a href="#" class="text-light me-3"><i class="fab fa-instagram fa-lg"></i></a>
                        <a href="#" class="text-light me-3"><i class="fab fa-twitter fa-lg"></i></a>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 mb-4">
                    <h5><i class="fas fa-phone"></i> Contact</h5>
                    ${address ? `<p><i class="fas fa-map-marker-alt me-2"></i>${address.replace(/\n/g, '<br>')}</p>` : ''}
                    ${phone ? `<p><i class="fas fa-phone me-2"></i>${phone}</p>` : ''}
                    ${email ? `<p><i class="fas fa-envelope me-2"></i>${email}</p>` : ''}
                    ${openingHours ? `<h6 class="mt-3"><i class="fas fa-clock"></i> Horaires</h6><p class="small">${openingHours.replace(/\n/g, '<br>')}</p>` : ''}
                </div>
                ${showNewsletter ? `
                <div class="col-lg-4 col-md-12 mb-4">
                    <h5><i class="fas fa-envelope-open"></i> ${newsletterTitle || 'Newsletter'}</h5>
                    <p>${newsletterDescription || 'Restez informé de nos dernières nouveautés'}</p>
                    <div class="input-group">
                        <input type="email" class="form-control" placeholder="Votre email">
                        <button class="btn btn-primary" type="button">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
                ` : ''}
            </div>
            <hr class="my-4">
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-0">${copyrightText || '© 2024 Bijoux Store. Tous droits réservés.'}</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <a href="#" class="text-light me-3">Mentions légales</a>
                    <a href="#" class="text-light me-3">Politique de confidentialité</a>
                    <a href="#" class="text-light">CGV</a>
                </div>
            </div>
        </div>
    `;
    
    document.getElementById('footerPreview').innerHTML = preview;
    const modal = new bootstrap.Modal(document.getElementById('previewModal'));
    modal.show();
}

// Auto-sauvegarde des modifications
let saveTimeout;
document.querySelectorAll('input, textarea').forEach(function(element) {
    element.addEventListener('input', function() {
        clearTimeout(saveTimeout);
        saveTimeout = setTimeout(function() {
            // Indication visuelle que les modifications sont en attente
            document.querySelector('button[type="submit"]').innerHTML = '<i class="fas fa-save"></i> Modifications en attente...';
        }, 1000);
    });
});
</script>
{% endblock %}
